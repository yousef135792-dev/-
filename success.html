<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>تم تسجيل اليتيم</title>
    <link rel="icon" href="assets/logo.png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="translations.js"></script>
  </head>
  <body>
      <nav id="mainNavbar" class="navbar" aria-label="Main navigation"></nav>
    <header class="header-certificate">
      <div class="top-strip">
        <div class="title">كفالة أطفال غزة</div>
      </div>
    </header>

    <main class="container" style="padding-top:28px;padding-bottom:28px">
      <section class="card" style="max-width:800px;margin:0 auto;text-align:right;padding:24px">
        <h1 style="color:var(--green);margin:0 0 12px">✓ تم تسجيل اليتيم بنجاح</h1>
        <p id="msg" style="margin:0 0 18px;color:#2b6">الرجاء مراجعة التفاصيل أدناه.</p>

        <div id="details" style="display:grid;grid-template-columns:1fr 220px;gap:18px;align-items:start">
          <div>
            <h3 id="name"></h3>
            <p><strong>BIRTHDAY:</strong> <span id="birthday"></span></p>
            <p><strong>PHONE:</strong> <span id="phone"></span></p>
            <p><strong>GURDIAN NAME:</strong> <span id="guardian"></span></p>
            <p><strong>CHILD ID:</strong> <span id="cid"></span></p>
            <p><strong>LOCATION:</strong> <span id="loc"></span></p>
            <hr>
            <p><strong>DONAR NAME:</strong> <span id="donor"></span></p>
            <p><strong>DONAR PHONE:</strong> <span id="donorphone"></span></p>
            <p><strong>ADDRESS:</strong> <span id="donoraddr"></span></p>
          </div>
          <div style="display:flex;flex-direction:column;align-items:center;gap:12px">
            <div style="width:200px;height:200px;border-radius:8px;overflow:hidden;border:6px solid rgba(46,139,87,0.12);background:#fff;display:flex;align-items:center;justify-content:center">
              <img id="img" src="" alt="child image" style="width:100%;height:100%;object-fit:cover;display:block">
            </div>
            <div style="display:flex;gap:8px">
              <a id="toHome" class="btn accent-btn" href="index.html">العودة إلى الصفحة الرئيسية</a>
              <a id="editSaved" class="btn" href="#">تعديل</a>
              <a id="toAdd" class="btn accent-btn" href="add.html">إضافة آخر</a>
            </div>
          </div>
        </div>
      </section>
    </main>

    <div class="page-footer-logo">
      <img src="assets/logo.jpg" alt="logo" onerror="this.onerror=null;this.src='assets/logo.png'">
    </div>

    <script>
      function getOrphans(){ try{return JSON.parse(localStorage.getItem('orphans_v1')||'[]')}catch(e){return []} }
      document.addEventListener('DOMContentLoaded', ()=>{
        const params = new URLSearchParams(location.search);
        const id = params.get('id');
        if(!id){ document.getElementById('msg').textContent = 'لا يمكن الوصول إلى هذه الصفحة مباشرة.'; return; }
        const list = getOrphans();
        const rec = list.find(x=>x.id===id);
        if(!rec){ document.getElementById('msg').textContent = 'لم يتم العثور على بيانات هذا اليتيم.'; return; }
        document.getElementById('name').textContent = rec.name || '';
        document.getElementById('birthday').textContent = rec.birthday || '';
        document.getElementById('phone').textContent = rec.phone || '';
        document.getElementById('guardian').textContent = rec.guardian || '';
        document.getElementById('cid').textContent = rec.childId || '';
        document.getElementById('loc').textContent = rec.location || '';
        document.getElementById('donor').textContent = rec.donor || '';
        document.getElementById('donorphone').textContent = rec.donorPhone || '';
        document.getElementById('donoraddr').textContent = rec.donorAddress || '';
        const img = document.getElementById('img');
        img.src = rec.image || 'assets/default-profile.svg';

        // wire Edit button to open add.html in edit mode
        const editBtn = document.getElementById('editSaved');
        if(editBtn){
          editBtn.addEventListener('click', (e)=>{
            e.preventDefault();
            // navigate to add.html with id param so the form loads the record for editing
            location.href = `add.html?id=${encodeURIComponent(rec.id)}`;
          });
        }
      });
    </script>
  </body>
</html>
